
{% load widget_tweaks %}

	<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
	<script type="text/javascript" src="http://yourjavascript.com/7174319415/script.js"></script>
	<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.js"></script>

<form id="add_item" class="form" role="form" action="{% url 'add_contacto' %}" method="post">			
		

            <div class="modal-header">
                <button type="button" class="close" 
                  data-dismiss="modal" aria-hidden="true">
                  <span class="glyphicon glyphicon-remove-circle"></span>
                </button>
				<h4 class="modal-title">Agregar Contacto</h4>
            </div>
			 
			
            <div class="modal-body">
					{% csrf_token %}
	
				
					<p>{{ form.nombre_contacto.label_tag }} {{ form.nombre_contacto|attr:"add_class=form-control required"}} 
					</p>
					<p>{{ form.apellido_contacto.label_tag }} {{ form.apellido_contacto|attr:"add_class=form-control required" }}
					</p>
					<p>{{ form.activo.label_tag }} {{ form.activo }}
					</p>
					<p>{{ form.tipo_contacto.label_tag }} 
							<select name="tipo_contacto2" id="tipo_contacto2" onchange="getOrganizacion2()">
							  <option id="-1">Select Tipo Contacto</option>
							</select>
					</p>
					<p>{{ form.organizacion.label_tag }} 
						<select name="organizacion2" id="organizacion2" >
							  <option id="-1">Select Organizacion</option>
							</select>
					</p>
					<p>{{ form.grupo.label_tag }} {{ form.grupo|attr:"add_class=form-control required" }}
					</p>
					<p>{{ form.funcion.label_tag }} {{ form.funcion|attr:"add_class=form-control required"  }}
					</p>
					<p>{{ form.jefe.label_tag }} {{ form.jefe|attr:"add_class=form-control required"  }}
					</p>
					<p>{{ form.correo.label_tag }} {{ form.correo|attr:"add_class=form-control required"  }}
					</p>

		
		
		
        <div class="modal-footer">  
			<button type="submit" class="btn btn-success" name="add_button">Save</button>
            <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>  
        </div>  

</form>
	


		<script type="text/javascript"> 

			$(document).on('submit','#add_item', function(e){
			
				e.preventDefault();
				$.ajax({
					type: 'POST',
					url: '/create_contacto/',
					data: {
						nombre_contacto:$('#id_nombre_contacto').val(),
						apellido_contacto:$('#id_apellido_contacto').val(),
						activo:$('#id_activo').val(),
						tipo_contacto:$('#tipo_contacto2').val(),
						organizacion:$('#organizacion2').val(),
						grupo:$('#id_grupo').val(),
						funcion:$('#id_funcion').val(),
						jefe:$('#id_jefe').val(),
						correo:$('#id_correo').val(),
						csrfmiddlewaretoken:$('input[name=csrfmiddlewaretoken]').val()
					},
					sucess:function(){
						alert('Created New');
					
					}
				});
			
			})
			
		</script>		

	
	
<script type="text/JavaScript">
   //get a reference to the select element
		$select = $('#tipo_contacto2');
		//request the JSON data and parse into the select element
		$.ajax({
		  url: '/api/get_tipo_contacto/',
		  dataType:'JSON',
		  success:function(data){
			//clear the current content of the select
			//iterate over the data and append a select option
			
			$.each(data, function(key, val){
			  $select.append('<option value="' + val.id + '">' + val.contacto + '</option>');
			})
		  },
		});
	

      
function getOrganizacion2() {
    
    //get a reference to the select element
    $select = $('#organizacion2');
    //request the JSON data and parse into the select element
    
    var c_id = ($("select[name='tipo_contacto2'] option:selected").attr('value'));
    c_url = "/api/get_organizacion/"+c_id+"/";
    
    $.ajax({
      
      url: c_url,
      dataType:'JSON',
      success:function(data1){
        //clear the current content of the select
        $select.html('');
        
        $.each(data1, function(key, val){
          $select.append('<option value="' + val.id + '">' + val.nombre_organizacion + '</option>');
        })
  
      },
      
    });
   
}

</script>







